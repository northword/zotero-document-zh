---
title: Zotero在更新文档时出错
author:
    - name: Chikit_L
date: 2023-11-23 23:09:00
updated: 2023-11-23 23:09:00
---

# Zotero在更新文档时出错

在翻译[官方文档](https://www.zotero.org/support/kb/debugging_broken_documents)的基础上，进行了再次整合，以`Microsoft Word`为例进行操作。如果您使用的是`Google Docs`或者`LibreOffice`，可访问[官方文档](https://www.zotero.org/support/kb/debugging_broken_documents)获取帮助。

##

如果您在尝试在一个**新的空文档**中使用Zotero时出错，请参阅[文字处理器插件故障排除](https://www.zotero.org/support/word_processor_plugin_troubleshooting)。

如果您可以在新的空Word文档中插入引文，但在**现有文档**中使用Zotero时出现错误，可以按照以下步骤进行问题排查：

![更新文档时出错](../../assets/image-更新文档时出错.png)

1. 检查word设置

    在`文件-选项-高级`，对`键入内容替换所选问题`进行勾选，问题即可得到解决。
    如问题未得到解决，请按照后续步骤逐步进行排查。

    ![键入内容替换所选文字](../../assets/image-键入内容替换所选文字.png)

2. 重启Zotero和Word。

3. 确保您使用的是最新版本的Zotero和Word。  

4. 排除故障时，禁用Word中的修订功能，因为它在使用Zotero时会产生复杂的效果。
   如果在插入或修改Zotero引文时启用了修订功能，它可能会将文档中的许多或所有Zotero引文标记为已更改。如果您以前启用了修订功能，请尝试接受所有更改，看看这是否能解决问题。

5. 检查图片标题中的引用。Zotero不会让你插入它们，但如果你将引用复制到标题中，这很可能是问题的根源。删除这部分引用。

6. 尝试将文档内容复制并粘贴到新文档中，以查看问题是否消失。您可能需要点击`Document Preferences`按钮，您的旧引用才会被识别。

7. 通过复制文件本身，而不是通过复制和粘贴内容，制作文档的副本，用于调试。

8. 如果在Windows上使用OneDrive，请将文档的副本保存到本地硬盘，或者尝试重命名文件以删除文件名中的任何空格。OneDrive会干扰插件的使用，请在使用Zotero过程中避免与Onedrive同时使用。

9. 打开复制的文件，检查切换到不同的参考书目样式后是否出现错误。

10. 如果文档有参考书目（bibliography,），请删除它后检查是否仍然出现错误。

11. 调试时，如果您在Word插件中使用字段模式，显示字段代码而不是格式化文本可能会有所帮助。为此，请在Word中按Alt/Option-F9（或Alt/Option-Fn-F9）。

12. **隔离有问题的引用。**
     在文档副本中，每次删除一半内容，看看错误是否仍然发生。如果没有，使用 "撤消 "恢复已删除的部分，然后尝试删除另一半。对出现错误的部分重复删除一半的过程，如果两个部分都出现错误，则随机选取一个。继续这样做，直到找到出现问题时必须存在的最小部分（最好只有一个引文）。从原始文档中删除孤立的引文，问题就会消失（除非有多个断开的引文，在这种情况下您需要重复该过程）。
